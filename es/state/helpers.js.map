{"version":3,"sources":["../../src/state/helpers.js"],"names":["Stream","replace","createAction","select","actionSelector","action","stream","doubleCreator","tag","meta","x","getType","Object","defineProperties","value","enumerable","type","guardedReducer","guards","reducer","state","payload","i","ln","length","guard","trimType"],"mappings":"AAEA,SAASA,MAAT;AACA,SAASC,OAAT;AACA,SAASC,YAAT;AACA,SAASC,MAAT;;AAkBA,IAAMC,iBACHC,MAAD,IACGC,MAAD,IAAYH,OAAOE,MAAP,EAAeC,MAAf,CAFhB;;AASA,OAAO,SAASC,aAAT,CACLC,GADK,EACMC,IADN,EAE4B;AACjC,MAAMJ,SAAoC,OAAOI,IAAP,KAAgB,UAAhB,GACtCP,aAAaM,GAAb,EAAmBE,CAAD,IAAOA,CAAzB,EAA4BD,IAA5B,CADsC,GAEtCP,aAAaM,GAAb,CAFJ;AAGA,MAAMF,SAAuCF,eAAeC,OAAOM,OAAP,EAAf,CAA7C;AACAC,SAAOC,gBAAP,CAAwBR,MAAxB,EAAgC;AAC9BC,YAAQ;AACNQ,aAAYR,MADN;AAENS,kBAAY;AAFN,KADsB;AAK9BC,UAAM;AACJF,aAAYT,OAAOM,OAAP,EADR;AAEJI,kBAAY;AAFR;AALwB,GAAhC;AAUA,SAAOV,MAAP;AACD;;AAED,OAAO,IAAMY,iBAAiB,CAC5BC,MAD4B,EAE5BC,OAF4B,KAGzB,CAACC,KAAD,EAAWC,OAAX,KAA0B;AAC7B,OAAK,IAAIC,IAAI,CAAR,EAAWC,KAAKL,OAAOM,MAA5B,EAAoCF,IAAIC,EAAxC,EAA4CD,GAA5C,EAAiD;AAC/C,QAAMG,QAAQP,OAAOI,CAAP,CAAd;AACA,QAAI,CAACG,MAAML,KAAN,EAAaC,OAAb,CAAL,EACE,OAAOD,KAAP;AACH;AACD,SAAOD,QAAQC,KAAR,EAAeC,OAAf,CAAP;AACD,CAVM;;AAYP,OAAO,IAAMK,WACXzB,QAAQ,YAAR,EAAsB,EAAtB,CADK","file":"helpers.js","sourcesContent":["//@flow\n\nimport { Stream } from 'most'\nimport { replace } from 'ramda'\nimport { createAction } from 'redux-act'\nimport { select } from 'redux-most'\n\n\ntype ActionCreator<Type, Payload> =\n  (stream: Stream<any>) =>\n    Stream<Action<Type, Payload>>\n\ndeclare class Act<Tag = 'action'> { toString(): Tag }\n\ntype Action<Tag = 'action', Payload = {}, Meta = void> = {\n  (payload: Payload, meta: Meta): Action<Tag, Payload>,\n  // call$(payload: Payload, meta: Meta): Action<Tag, Payload>,\n  // (payload: Payload): Action<Tag, Payload>,\n  getType(): Tag,\n  type: Tag,\n  payload: Payload,\n}\n\nconst actionSelector =\n  (action: any): ActionCreator<any, any> =>\n    (stream) => select(action, stream)\n\nexport type ActionPair<Type, Payload, Meta = void> = Action<Type, Payload, Meta> & {\n  stream: ActionCreator<Type, Payload>,\n  type: Type,\n}\n\nexport function doubleCreator<Type, Payload, Meta>(\n  tag: Type, meta?: (pl: Payload, meta: Meta) => any\n): ActionPair<Type, Payload, Meta> {\n  const action: ActionPair<Type, Payload> = typeof meta === 'function'\n    ? createAction(tag, (x) => x, meta)\n    : createAction(tag)\n  const stream: ActionCreator<Type, Payload> = actionSelector(action.getType())\n  Object.defineProperties(action, {\n    stream: {\n      value     : stream,\n      enumerable: false,\n    },\n    type: {\n      value     : action.getType(),\n      enumerable: false,\n    }\n  })\n  return action\n}\n\nexport const guardedReducer = <S, -P>(\n  guards: ((state: S, payload: P) => boolean)[],\n  reducer: (state: S, payload: P) => S,\n) => (state: S, payload: P) => {\n  for (let i = 0, ln = guards.length; i < ln; i++) {\n    const guard = guards[i]\n    if (!guard(state, payload))\n      return state\n  }\n  return reducer(state, payload)\n}\n\nexport const trimType: (type: string) => string =\n  replace(/\\[\\d+\\]\\s*/, '')\n"]}