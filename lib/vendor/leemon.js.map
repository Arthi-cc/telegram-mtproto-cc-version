{"version":3,"sources":["../../src/vendor/leemon.js"],"names":["powMod","sub","eGCD_","greater","divide_","int2bigInt","str2bigInt","equalsInt","isZero","bigInt2str","dup","copy_","copyInt_","addInt_","rightShift_","leftShift_","sub_","add_","bpe","mask","radix","digitsStr","one","t","Array","ss","s0","s3","s4","s5","s6","s7","T","sa","mr_x1","mr_r","mr_a","eg_v","eg_u","eg_A","eg_B","eg_C","eg_D","primes","pows","s_i","s_i2","s_R","s_rm","s_q","s_n1","s_a","s_r2","s_n","s_b","s_d","s_x1","s_x2","s_aa","rpprb","k","buff","findPrimes","n","i","s","p","ans","millerRabinInt","x","b","length","millerRabin","j","powMod_","equals","squareMod_","bitSize","z","w","expand","randTruePrime","randTruePrime_","trim","randProbPrime","randProbPrimeRounds","divisible","B","randBigInt_","modInt","mod","mod_","addInt","mult","y","mult_","add","inverseMod","inverseMod_","multMod","multMod_","c","m","pm","dd","r","zz","recSize","Math","pow","floor","random","carry_","multInt_","GCD_","randBigInt","a","GCD","xc","yc","xp","yp","A","C","D","q","sing","qp","linComb_","max","halve_","negative","inverseModInt","inverseModInt_","v","g","greaterShift","shift","kx","ky","y1","y2","subShift_","linCombShift_","addShift_","bits","minSize","ceil","base","d","kk","parseInt","indexOf","substring","divInt_","len","ys","k1","k2","kn","np","mont_","ui","ks"],"mappings":";;;;;QAkagBA,M,GAAAA,M;QAOAC,G,GAAAA,G;QA6VAC,K,GAAAA,K;QA6FAC,O,GAAAA,O;QAyBAC,O,GAAAA,O;QAwFAC,U,GAAAA,U;QAaAC,U,GAAAA,U;QA2DAC,S,GAAAA,S;QA+BAC,M,GAAAA,M;QAUAC,U,GAAAA,U;QAyBAC,G,GAAAA,G;QAQAC,K,GAAAA,K;QAUAC,Q,GAAAA,Q;QAWAC,O,GAAAA,O;QAmBAC,W,GAAAA,W;QA2BAC,U,GAAAA,U;QA6HAC,I,GAAAA,I;QAiBAC,I,GAAAA,I;;;AAnzChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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","file":"leemon.js","sourcesContent":["//@flow\n\ntype Bytes = number[]\n\n////////////////////////////////////////////////////////////////////////////////////////\n// Big Integer Library v. 5.5\n// Created 2000, last modified 2013\n// Leemon Baird\n// www.leemon.com\n//\n// Version history:\n// v 5.5  17 Mar 2013\n//   - two lines of a form like \"if (x<0) x+=n\" had the \"if\" changed to \"while\" to\n//     handle the case when x<-n. (Thanks to James Ansell for finding that bug)\n// v 5.4  3 Oct 2009\n//   - added \"var i\" to greaterShift() so i is not global. (Thanks to PŽter Szab— for finding that bug)\n//\n// v 5.3  21 Sep 2009\n//   - added randProbPrime(k) for probable primes\n//   - unrolled loop in mont_ (slightly faster)\n//   - millerRabin now takes a bigInt parameter rather than an int\n//\n// v 5.2  15 Sep 2009\n//   - fixed capitalization in call to int2bigInt in randBigInt\n//     (thanks to Emili Evripidou, Reinhold Behringer, and Samuel Macaleese for finding that bug)\n//\n// v 5.1  8 Oct 2007\n//   - renamed inverseModInt_ to inverseModInt since it doesn't change its parameters\n//   - added functions GCD and randBigInt, which call GCD_ and randBigInt_\n//   - fixed a bug found by Rob Visser (see comment with his name below)\n//   - improved comments\n//\n// This file is public domain.   You can use it for any purpose without restriction.\n// I do not guarantee that it is correct, so use it at your own risk.  If you use\n// it for something interesting, I'd appreciate hearing about it.  If you find\n// any bugs or make any improvements, I'd appreciate hearing about those too.\n// It would also be nice if my name and URL were left in the comments.  But none\n// of that is required.\n//\n// This code defines a bigInt library for arbitrary-precision integers.\n// A bigInt is an array of integers storing the value in chunks of bpe bits,\n// little endian (buff[0] is the least significant word).\n// Negative bigInts are stored two's complement.  Almost all the functions treat\n// bigInts as nonnegative.  The few that view them as two's complement say so\n// in their comments.  Some functions assume their parameters have at least one\n// leading zero element. Functions with an underscore at the end of the name put\n// their answer into one of the arrays passed in, and have unpredictable behavior\n// in case of overflow, so the caller must make sure the arrays are big enough to\n// hold the answer.  But the average user should never have to call any of the\n// underscored functions.  Each important underscored function has a wrapper function\n// of the same name without the underscore that takes care of the details for you.\n// For each underscored function where a parameter is modified, that same variable\n// must not be used as another argument too.  So, you cannot square x by doing\n// multMod_(x,x,n).  You must use squareMod_(x,n) instead, or do y=dup(x); multMod_(x,y,n).\n// Or simply use the multMod(x,x,n) function without the underscore, where\n// such issues never arise, because non-underscored functions never change\n// their parameters; they always allocate new memory for the answer that is returned.\n//\n// These functions are designed to avoid frequent dynamic memory allocation in the inner loop.\n// For most functions, if it needs a BigInt as a local variable it will actually use\n// a global, and will only allocate to it only when it's not the right size.  This ensures\n// that when a function is called repeatedly with same-sized parameters, it only allocates\n// memory on the first call.\n//\n// Note that for cryptographic purposes, the calls to Math.random() must\n// be replaced with calls to a better pseudorandom number generator.\n//\n// In the following, \"bigInt\" means a bigInt with at least one leading zero element,\n// and \"integer\" means a nonnegative integer less than radix.  In some cases, integer\n// can be negative.  Negative bigInts are 2s complement.\n//\n// The following functions do not modify their inputs.\n// Those returning a bigInt, string, or Array will dynamically allocate memory for that value.\n// Those returning a boolean will return the integer 0 (false) or 1 (true).\n// Those returning boolean or int will not allocate memory except possibly on the first\n// time they're called with a given parameter size.\n//\n// bigInt  add(x,y)               //return (x+y) for bigInts x and y.\n// bigInt  addInt(x,n)            //return (x+n) where x is a bigInt and n is an integer.\n// string  bigInt2str(x,base)     //return a string form of bigInt x in a given base, with 2 <= base <= 95\n// int     bitSize(x)             //return how many bits long the bigInt x is, not counting leading zeros\n// bigInt  dup(x)                 //return a copy of bigInt x\n// boolean equals(x,y)            //is the bigInt x equal to the bigint y?\n// boolean equalsInt(x,y)         //is bigint x equal to integer y?\n// bigInt  expand(x,n)            //return a copy of x with at least n elements, adding leading zeros if needed\n// Array   findPrimes(n)          //return array of all primes less than integer n\n// bigInt  GCD(x,y)               //return greatest common divisor of bigInts x and y (each with same number of elements).\n// boolean greater(x,y)           //is x>y?  (x and y are nonnegative bigInts)\n// boolean greaterShift(x,y,shift)//is (x <<(shift*bpe)) > y?\n// bigInt  int2bigInt(t,n,m)      //return a bigInt equal to integer t, with at least n bits and m array elements\n// bigInt  inverseMod(x,n)        //return (x**(-1) mod n) for bigInts x and n.  If no inverse exists, it returns null\n// int     inverseModInt(x,n)     //return x**(-1) mod n, for integers x and n.  Return 0 if there is no inverse\n// boolean isZero(x)              //is the bigInt x equal to zero?\n// boolean millerRabin(x,b)       //does one round of Miller-Rabin base integer b say that bigInt x is possibly prime? (b is bigInt, 1<b<x)\n// boolean millerRabinInt(x,b)    //does one round of Miller-Rabin base integer b say that bigInt x is possibly prime? (b is int,    1<b<x)\n// bigInt  mod(x,n)               //return a new bigInt equal to (x mod n) for bigInts x and n.\n// int     modInt(x,n)            //return x mod n for bigInt x and integer n.\n// bigInt  mult(x,y)              //return x*y for bigInts x and y. This is faster when y<x.\n// bigInt  multMod(x,y,n)         //return (x*y mod n) for bigInts x,y,n.  For greater speed, let y<x.\n// boolean negative(x)            //is bigInt x negative?\n// bigInt  powMod(x,y,n)          //return (x**y mod n) where x,y,n are bigInts and ** is exponentiation.  0**0=1. Faster for odd n.\n// bigInt  randBigInt(n,s)        //return an n-bit random BigInt (n>=1).  If s=1, then the most significant of those n bits is set to 1.\n// bigInt  randTruePrime(k)       //return a new, random, k-bit, true prime bigInt using Maurer's algorithm.\n// bigInt  randProbPrime(k)       //return a new, random, k-bit, probable prime bigInt (probability it's composite less than 2^-80).\n// bigInt  str2bigInt(s,b,n,m)    //return a bigInt for number represented in string s in base b with at least n bits and m array elements\n// bigInt  sub(x,y)               //return (x-y) for bigInts x and y.  Negative answers will be 2s complement\n// bigInt  trim(x,k)              //return a copy of x with exactly k leading zero elements\n//\n//\n// The following functions each have a non-underscored version, which most users should call instead.\n// These functions each write to a single parameter, and the caller is responsible for ensuring the array\n// passed in is large enough to hold the result.\n//\n// void    addInt_(x,n)          //do x=x+n where x is a bigInt and n is an integer\n// void    add_(x,y)             //do x=x+y for bigInts x and y\n// void    copy_(x,y)            //do x=y on bigInts x and y\n// void    copyInt_(x,n)         //do x=n on bigInt x and integer n\n// void    GCD_(x,y)             //set x to the greatest common divisor of bigInts x and y, (y is destroyed).  (This never overflows its array).\n// boolean inverseMod_(x,n)      //do x=x**(-1) mod n, for bigInts x and n. Returns 1 (0) if inverse does (doesn't) exist\n// void    mod_(x,n)             //do x=x mod n for bigInts x and n. (This never overflows its array).\n// void    mult_(x,y)            //do x=x*y for bigInts x and y.\n// void    multMod_(x,y,n)       //do x=x*y  mod n for bigInts x,y,n.\n// void    powMod_(x,y,n)        //do x=x**y mod n, where x,y,n are bigInts (n is odd) and ** is exponentiation.  0**0=1.\n// void    randBigInt_(b,n,s)    //do b = an n-bit random BigInt. if s=1, then nth bit (most significant bit) is set to 1. n>=1.\n// void    randTruePrime_(ans,k) //do ans = a random k-bit true random prime (not just probable prime) with 1 in the msb.\n// void    sub_(x,y)             //do x=x-y for bigInts x and y. Negative answers will be 2s complement.\n//\n// The following functions do NOT have a non-underscored version.\n// They each write a bigInt result to one or more parameters.  The caller is responsible for\n// ensuring the arrays passed in are large enough to hold the results.\n//\n// void addShift_(x,y,ys)       //do x=x+(y<<(ys*bpe))\n// void carry_(x)               //do carries and borrows so each element of the bigInt x fits in bpe bits.\n// void divide_(x,y,q,r)        //divide x by y giving quotient q and remainder r\n// int  divInt_(x,n)            //do x=floor(x/n) for bigInt x and integer n, and return the remainder. (This never overflows its array).\n// int  eGCD_(x,y,d,a,b)        //sets a,b,d to positive bigInts such that d = GCD_(x,y) = a*x-b*y\n// void halve_(x)               //do x=floor(|x|/2)*sgn(x) for bigInt x in 2's complement.  (This never overflows its array).\n// void leftShift_(x,n)         //left shift bigInt x by n bits.  n<bpe.\n// void linComb_(x,y,a,b)       //do x=a*x+b*y for bigInts x and y and integers a and b\n// void linCombShift_(x,y,b,ys) //do x=x+b*(y<<(ys*bpe)) for bigInts x and y, and integers b and ys\n// void mont_(x,y,n,np)         //Montgomery multiplication (see comments where the function is defined)\n// void multInt_(x,n)           //do x=x*n where x is a bigInt and n is an integer.\n// void rightShift_(x,n)        //right shift bigInt x by n bits.  0 <= n < bpe. (This never overflows its array).\n// void squareMod_(x,n)         //do x=x*x  mod n for bigInts x,n\n// void subShift_(x,y,ys)       //do x=x-(y<<(ys*bpe)). Negative answers will be 2s complement.\n//\n// The following functions are based on algorithms from the _Handbook of Applied Cryptography_\n//    powMod_()           = algorithm 14.94, Montgomery exponentiation\n//    eGCD_,inverseMod_() = algorithm 14.61, Binary extended GCD_\n//    GCD_()              = algorothm 14.57, Lehmer's algorithm\n//    mont_()             = algorithm 14.36, Montgomery multiplication\n//    divide_()           = algorithm 14.20  Multiple-precision division\n//    squareMod_()        = algorithm 14.16  Multiple-precision squaring\n//    randTruePrime_()    = algorithm  4.62, Maurer's algorithm\n//    millerRabin()       = algorithm  4.24, Miller-Rabin algorithm\n//\n// Profiling shows:\n//     randTruePrime_() spends:\n//         10% of its time in calls to powMod_()\n//         85% of its time in calls to millerRabin()\n//     millerRabin() spends:\n//         99% of its time in calls to powMod_()   (always with a base of 2)\n//     powMod_() spends:\n//         94% of its time in calls to mont_()  (almost always with x==y)\n//\n// This suggests there are several ways to speed up this library slightly:\n//     - convert powMod_ to use a Montgomery form of k-ary window (or maybe a Montgomery form of sliding window)\n//         -- this should especially focus on being fast when raising 2 to a power mod n\n//     - convert randTruePrime_() to use a minimum r of 1/3 instead of 1/2 with the appropriate change to the test\n//     - tune the parameters in randTruePrime_(), including c, m, and recLimit\n//     - speed up the single loop in mont_() that takes 95% of the runtime, perhaps by reducing checking\n//       within the loop when all the parameters are the same length.\n//\n// There are several ideas that look like they wouldn't help much at all:\n//     - replacing trial division in randTruePrime_() with a sieve (that speeds up something taking almost no time anyway)\n//     - increase bpe from 15 to 30 (that would help if we had a 32*32->64 multiplier, but not with JavaScript's 32*32->32)\n//     - speeding up mont_(x,y,n,np) when x==y by doing a non-modular, non-Montgomery square\n//       followed by a Montgomery reduction.  The intermediate answer will be twice as long as x, so that\n//       method would be slower.  This is unfortunate because the code currently spends almost all of its time\n//       doing mont_(x,x,...), both for randTruePrime_() and powMod_().  A faster method for Montgomery squaring\n//       would have a large impact on the speed of randTruePrime_() and powMod_().  HAC has a couple of poorly-worded\n//       sentences that seem to imply it's faster to do a non-modular square followed by a single\n//       Montgomery reduction, but that's obviously wrong.\n////////////////////////////////////////////////////////////////////////////////////////\n\n//globals\nexport var bpe=0;         //bits stored per array element\nvar mask=0;        //AND this with an array element to chop it down to bpe bits\nvar radix=mask+1;  //equals 2^bpe.  A single 1 bit to the left of the last bit of mask.\n\n//the digits for converting to different bases\nvar digitsStr='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_=!@#$%^&*()[]{}|;:,.<>/?`~ \\\\\\'\"+-';\n\n//initialize the global variables\nfor (bpe=0; (1<<(bpe+1)) > (1<<bpe); bpe++);  //bpe=number of bits in the mantissa on this platform\nbpe>>=1;                   //bpe=number of bits in one element of the array representing the bigInt\nmask=(1<<bpe)-1;           //AND the mask with an integer to get its bpe least significant bits\nradix=mask+1;              //2^bpe.  a single 1 bit to the left of the first bit of mask\nexport var one=int2bigInt(1, 1, 1);     //constant used in powMod_()\n\n//the following global variables are scratchpad memory to\n//reduce dynamic memory allocation in the inner loop\nvar t=new Array(0);\nvar ss=t;       //used in mult_()\nvar s0=t;       //used in multMod_(), squareMod_()\n// var s1=t;       //used in powMod_(), multMod_(), squareMod_()\n// var s2=t;       //used in powMod_(), multMod_()\nvar s3=t;       //used in powMod_()\nvar s4=t, s5=t; //used in mod_()\nvar s6=t;       //used in bigInt2str()\nvar s7=t;       //used in powMod_()\nvar T=t;        //used in GCD_()\nvar sa=t;       //used in mont_()\nvar mr_x1=t, mr_r=t, mr_a=t,                                      //used in millerRabin()\n    eg_v=t, eg_u=t, eg_A=t, eg_B=t, eg_C=t, eg_D=t                //used in eGCD_(), inverseMod_()\n    //, md_q1=t, md_q2=t, md_q3=t, md_r=t, md_r1=t, md_r2=t, md_tt=t, //used in mod_()\n\n    , primes=t, pows=t, s_i=t, s_i2=t, s_R=t, s_rm=t, s_q=t, s_n1=t,\n    s_a=t, s_r2=t, s_n=t, s_b=t, s_d=t, s_x1=t, s_x2=t, s_aa=t, //used in randTruePrime_()\n\n    rpprb=t; //used in randProbPrimeRounds() (which also uses \"primes\")\n\n////////////////////////////////////////////////////////////////////////////////////////\n\nvar k, buff;\n\n//return array of all primes less than integer n\nfunction findPrimes(n: number) {\n  var i, s, p, ans;\n  s=new Array(n);\n  for (i=0; i<n; i++)\n    s[i]=0;\n  s[0]=2;\n  p=0;    //first p elements of s are primes, the rest are a sieve\n  for (;s[p]<n;) {                  //s[p] is the pth prime\n    for (i=s[p]*s[p]; i<n; i+=s[p]) //mark multiples of s[p]\n      s[i]=1;\n    p++;\n    s[p]=s[p-1]+1;\n    for (; s[p]<n && s[s[p]]; s[p]++); //find next prime (where s[p]==0)\n  }\n  ans=new Array(p);\n  for (i=0; i<p; i++)\n    ans[i]=s[i];\n  return ans;\n}\n\n\n//does a single round of Miller-Rabin base b consider x to be a possible prime?\n//x is a bigInt, and b is an integer, with b<x\nfunction millerRabinInt(x: Bytes, b: number) {\n  if (mr_x1.length!=x.length) {\n    mr_x1=dup(x);\n    mr_r=dup(x);\n    mr_a=dup(x);\n  }\n\n  copyInt_(mr_a, b);\n  return millerRabin(x, mr_a);\n}\n\n//does a single round of Miller-Rabin base b consider x to be a possible prime?\n//x and b are bigInts with b<x\nfunction millerRabin(x: Bytes, b: Bytes) {\n  var i, j, k, s;\n\n  if (mr_x1.length!=x.length) {\n    mr_x1=dup(x);\n    mr_r=dup(x);\n    mr_a=dup(x);\n  }\n\n  copy_(mr_a, b);\n  copy_(mr_r, x);\n  copy_(mr_x1, x);\n\n  addInt_(mr_r, -1);\n  addInt_(mr_x1, -1);\n\n  //s=the highest power of two that divides mr_r\n  k=0;\n  for (i=0; i<mr_r.length; i++)\n    for (j=1; j<mask; j<<=1)\n      if (x[i] & j) {\n        s=(k<mr_r.length+bpe ? k : 0);\n        i=mr_r.length;\n        j=mask;\n      } else\n        k++;\n\n  if (s)\n    rightShift_(mr_r, s);\n\n  powMod_(mr_a, mr_r, x);\n\n  if (!equalsInt(mr_a, 1) && !equals(mr_a, mr_x1)) {\n    j=1;\n    //$off\n    while (j<=s-1 && !equals(mr_a, mr_x1)) {\n      squareMod_(mr_a, x);\n      if (equalsInt(mr_a, 1)) {\n        return 0;\n      }\n      j++;\n    }\n    if (!equals(mr_a, mr_x1)) {\n      return 0;\n    }\n  }\n  return 1;\n}\n\n//returns how many bits long the bigInt is, not counting leading zeros.\nfunction bitSize(x: Bytes) {\n  var j, z, w;\n  for (j=x.length-1; (x[j]==0) && (j>0); j--);\n  for (z=0, w=x[j]; w; (w>>=1), z++);\n  z+=bpe*j;\n  return z;\n}\n\n//return a copy of x with at least n elements, adding leading zeros if needed\nfunction expand(x: Bytes, n: number) {\n  var ans=int2bigInt(0, (x.length>n ? x.length : n)*bpe, 0);\n  copy_(ans, x);\n  return ans;\n}\n\n//return a k-bit true random prime using Maurer's algorithm.\nfunction randTruePrime(k: number) {\n  var ans=int2bigInt(0, k, 0);\n  randTruePrime_(ans, k);\n  return trim(ans, 1);\n}\n\n//return a k-bit random probable prime with probability of error < 2^-80\nfunction randProbPrime(k: number) {\n  if (k>=600) return randProbPrimeRounds(k, 2); //numbers from HAC table 4.3\n  if (k>=550) return randProbPrimeRounds(k, 4);\n  if (k>=500) return randProbPrimeRounds(k, 5);\n  if (k>=400) return randProbPrimeRounds(k, 6);\n  if (k>=350) return randProbPrimeRounds(k, 7);\n  if (k>=300) return randProbPrimeRounds(k, 9);\n  if (k>=250) return randProbPrimeRounds(k, 12); //numbers from HAC table 4.4\n  if (k>=200) return randProbPrimeRounds(k, 15);\n  if (k>=150) return randProbPrimeRounds(k, 18);\n  if (k>=100) return randProbPrimeRounds(k, 27);\n              return randProbPrimeRounds(k, 40); //number from HAC remark 4.26 (only an estimate)\n}\n\n//return a k-bit probable random prime using n rounds of Miller Rabin (after trial division with small primes)\nfunction randProbPrimeRounds(k: number, n: number) {\n  var ans, i, divisible, B;\n  B=30000;  //B is largest prime to use in trial division\n  ans=int2bigInt(0, k, 0);\n\n  //optimization: try larger and smaller B to find the best limit.\n\n  if (primes.length==0)\n    primes=findPrimes(30000);  //check for divisibility by primes <=30000\n\n  if (rpprb.length!=ans.length)\n    rpprb=dup(ans);\n\n  for (;;) { //keep trying random values for ans until one appears to be prime\n    //optimization: pick a random number times L=2*3*5*...*p, plus a\n    //   random element of the list of all numbers in [0,L) not divisible by any prime up to p.\n    //   This can reduce the amount of random number generation.\n\n    randBigInt_(ans, k, 0); //ans = a random odd number to check\n    ans[0] |= 1;\n    divisible=0;\n\n    //check ans for divisibility by small primes up to B\n    for (i=0; (i<primes.length) && (primes[i]<=B); i++)\n      if (modInt(ans, primes[i])==0 && !equalsInt(ans, primes[i])) {\n        divisible=1;\n        break;\n      }\n\n    //optimization: change millerRabin so the base can be bigger than the number being checked, then eliminate the while here.\n\n    //do n rounds of Miller Rabin, with random bases less than ans\n    for (i=0; i<n && !divisible; i++) {\n      randBigInt_(rpprb, k, 0);\n      while (!greater(ans, rpprb)) //pick a random rpprb that's < ans\n        randBigInt_(rpprb, k, 0);\n      if (!millerRabin(ans, rpprb))\n        divisible=1;\n    }\n\n    if (!divisible)\n      return ans;\n  }\n}\n\n//return a new bigInt equal to (x mod n) for bigInts x and n.\nfunction mod(x: Bytes, n: Bytes) {\n  var ans=dup(x);\n  mod_(ans, n);\n  return trim(ans, 1);\n}\n\n//return (x+n) where x is a bigInt and n is an integer.\nfunction addInt(x: Bytes, n: number) {\n  var ans=expand(x, x.length+1);\n  addInt_(ans, n);\n  return trim(ans, 1);\n}\n\n//return x*y for bigInts x and y. This is faster when y<x.\nfunction mult(x: Bytes, y: Bytes) {\n  var ans=expand(x, x.length+y.length);\n  mult_(ans, y);\n  return trim(ans, 1);\n}\n\n//return (x**y mod n) where x,y,n are bigInts and ** is exponentiation.  0**0=1. Faster for odd n.\nexport function powMod(x: Bytes, y: Bytes, n: Bytes) {\n  var ans=expand(x, n.length);\n  powMod_(ans, trim(y, 2), trim(n, 2));  //this should work without the trim, but doesn't\n  return trim(ans, 1);\n}\n\n//return (x-y) for bigInts x and y.  Negative answers will be 2s complement\nexport function sub(x: Bytes, y: Bytes) {\n  var ans=expand(x, (x.length>y.length ? x.length+1 : y.length+1));\n  sub_(ans, y);\n  return trim(ans, 1);\n}\n\n//return (x+y) for bigInts x and y.\nfunction add(x: Bytes, y: Bytes) {\n  var ans=expand(x, (x.length>y.length ? x.length+1 : y.length+1));\n  add_(ans, y);\n  return trim(ans, 1);\n}\n\n//return (x**(-1) mod n) for bigInts x and n.  If no inverse exists, it returns null\nfunction inverseMod(x: Bytes, n: Bytes) {\n  var ans=expand(x, n.length);\n  var s;\n  s=inverseMod_(ans, n);\n  return s ? trim(ans, 1) : null;\n}\n\n//return (x*y mod n) for bigInts x,y,n.  For greater speed, let y<x.\nfunction multMod(x: Bytes, y: Bytes, n: Bytes) {\n  var ans=expand(x, n.length);\n  multMod_(ans, y, n);\n  return trim(ans, 1);\n}\n\n//generate a k-bit true random prime using Maurer's algorithm,\n//and put it into ans.  The bigInt ans must be large enough to hold it.\nfunction randTruePrime_(ans: Bytes, k: number) {\n  var c, m, pm, dd, j, r, B, divisible, z, zz, recSize;\n  var w;\n  if (primes.length==0)\n    primes=findPrimes(30000);  //check for divisibility by primes <=30000\n\n  if (pows.length==0) {\n    pows=new Array(512);\n    for (j=0; j<512; j++) {\n      pows[j]=Math.pow(2, j/511.-1.);\n    }\n  }\n\n  //c and m should be tuned for a particular machine and value of k, to maximize speed\n  c=0.1;  //c=0.1 in HAC\n  m=20;   //generate this k-bit number by first recursively generating a number that has between k/2 and k-m bits\n  var recLimit=20; //stop recursion when k <=recLimit.  Must have recLimit >= 2\n\n  if (s_i2.length!=ans.length) {\n    s_i2=dup(ans);\n    s_R =dup(ans);\n    s_n1=dup(ans);\n    s_r2=dup(ans);\n    s_d =dup(ans);\n    s_x1=dup(ans); //TODO Seems like a bug in eslint, reports as unused\n    s_x2=dup(ans);\n    s_b =dup(ans);\n    s_n =dup(ans);\n    s_i =dup(ans);\n    s_rm=dup(ans);\n    s_q =dup(ans);\n    s_a =dup(ans);\n    s_aa=dup(ans);\n  }\n\n  if (k <= recLimit) {  //generate small random primes by trial division up to its square root\n    pm=(1<<((k+2)>>1))-1; //pm is binary number with all ones, just over sqrt(2^k)\n    copyInt_(ans, 0);\n    for (dd=1; dd;) {\n      dd=0;\n      ans[0]= 1 | (1<<(k-1)) | Math.floor(Math.random()*(1<<k));  //random, k-bit, odd integer, with msb 1\n      for (j=1; (j<primes.length) && ((primes[j]&pm)==primes[j]); j++) { //trial division by all primes 3...sqrt(2^k)\n        if (0==(ans[0]%primes[j])) {\n          dd=1;\n          break;\n        }\n      }\n    }\n    carry_(ans);\n    return;\n  }\n\n  B=c*k*k;    //try small primes up to B (or all the primes[] array if the largest is less than B).\n  if (k>2*m)  //generate this k-bit number by first recursively generating a number that has between k/2 and k-m bits\n    for (r=1; k-k*r<=m; )\n      r=pows[Math.floor(Math.random()*512)];   //r=Math.pow(2,Math.random()-1);\n  else\n    r=.5;\n\n  //simulation suggests the more complex algorithm using r=.333 is only slightly faster.\n\n  recSize=Math.floor(r*k)+1;\n\n  randTruePrime_(s_q, recSize);\n  copyInt_(s_i2, 0);\n  s_i2[Math.floor((k-2)/bpe)] |= (1<<((k-2)%bpe));   //s_i2=2^(k-2)\n  divide_(s_i2, s_q, s_i, s_rm);                        //s_i=floor((2^(k-1))/(2q))\n\n  z=bitSize(s_i);\n\n  for (;;) {\n    for (;;) {  //generate z-bit numbers until one falls in the range [0,s_i-1]\n      randBigInt_(s_R, z, 0);\n      if (greater(s_i, s_R))\n        break;\n    }                //now s_R is in the range [0,s_i-1]\n    addInt_(s_R, 1);  //now s_R is in the range [1,s_i]\n    add_(s_R, s_i);   //now s_R is in the range [s_i+1,2*s_i]\n\n    copy_(s_n, s_q);\n    mult_(s_n, s_R);\n    multInt_(s_n, 2);\n    addInt_(s_n, 1);    //s_n=2*s_R*s_q+1\n\n    copy_(s_r2, s_R);\n    multInt_(s_r2, 2);  //s_r2=2*s_R\n\n    //check s_n for divisibility by small primes up to B\n    for (divisible=0, j=0; (j<primes.length) && (primes[j]<B); j++)\n      if (modInt(s_n, primes[j])==0 && !equalsInt(s_n, primes[j])) {\n        divisible=1;\n        break;\n      }\n\n    if (!divisible)    //if it passes small primes check, then try a single Miller-Rabin base 2\n      if (!millerRabinInt(s_n, 2)) //this line represents 75% of the total runtime for randTruePrime_\n        divisible=1;\n\n    if (!divisible) {  //if it passes that test, continue checking s_n\n      addInt_(s_n, -3);\n      for (j=s_n.length-1; (s_n[j]==0) && (j>0); j--);  //strip leading zeros\n      for (zz=0, w=s_n[j]; w; (w>>=1), zz++);\n      zz+=bpe*j;                             //zz=number of bits in s_n, ignoring leading zeros\n      for (;;) {  //generate z-bit numbers until one falls in the range [0,s_n-1]\n        randBigInt_(s_a, zz, 0);\n        if (greater(s_n, s_a))\n          break;\n      }                //now s_a is in the range [0,s_n-1]\n      addInt_(s_n, 3);  //now s_a is in the range [0,s_n-4]\n      addInt_(s_a, 2);  //now s_a is in the range [2,s_n-2]\n      copy_(s_b, s_a);\n      copy_(s_n1, s_n);\n      addInt_(s_n1, -1);\n      powMod_(s_b, s_n1, s_n);   //s_b=s_a^(s_n-1) modulo s_n\n      addInt_(s_b, -1);\n      if (isZero(s_b)) {\n        copy_(s_b, s_a);\n        powMod_(s_b, s_r2, s_n);\n        addInt_(s_b, -1);\n        copy_(s_aa, s_n);\n        copy_(s_d, s_b);\n        GCD_(s_d, s_n);  //if s_b and s_n are relatively prime, then s_n is a prime\n        if (equalsInt(s_d, 1)) {\n          copy_(ans, s_aa);\n          return;     //if we've made it this far, then s_n is absolutely guaranteed to be prime\n        }\n      }\n    }\n  }\n}\n\n//Return an n-bit random BigInt (n>=1).  If s=1, then the most significant of those n bits is set to 1.\nfunction randBigInt(n: number, s: number) {\n  var a, b;\n  a=Math.floor((n-1)/bpe)+2; //# array elements to hold the BigInt with a leading 0 element\n  b=int2bigInt(0, 0, a);\n  randBigInt_(b, n, s);\n  return b;\n}\n\n//Set b to an n-bit random BigInt.  If s=1, then the most significant of those n bits is set to 1.\n//Array b must be big enough to hold the result. Must have n>=1\nfunction randBigInt_(b: Bytes, n: number, s: number) {\n  var i, a;\n  for (i=0; i<b.length; i++)\n    b[i]=0;\n  a=Math.floor((n-1)/bpe)+1; //# array elements to hold the BigInt\n  for (i=0; i<a; i++) {\n    b[i]=Math.floor(Math.random()*(1<<(bpe-1)));\n  }\n  b[a-1] &= (2<<((n-1)%bpe))-1;\n  if (s==1)\n    b[a-1] |= (1<<((n-1)%bpe));\n}\n\n//Return the greatest common divisor of bigInts x and y (each with same number of elements).\nfunction GCD(x: Bytes, y: Bytes) {\n  var xc, yc;\n  xc=dup(x);\n  yc=dup(y);\n  GCD_(xc, yc);\n  return xc;\n}\n\n//set x to the greatest common divisor of bigInts x and y (each with same number of elements).\n//y is destroyed.\nfunction GCD_(x: Bytes, y: Bytes) {\n  var i, xp, yp, A, B, C, D, q, sing;\n  var qp;\n  if (T.length!=x.length)\n    T=dup(x);\n\n  sing=1;\n  while (sing) { //while y has nonzero elements other than y[0]\n    sing=0;\n    for (i=1; i<y.length; i++) //check if y has nonzero elements other than 0\n      if (y[i]) {\n        sing=1;\n        break;\n      }\n    if (!sing) break; //quit when y all zero elements except possibly y[0]\n\n    for (i=x.length; !x[i] && i>=0; i--);  //find most significant element of x\n    xp=x[i];\n    yp=y[i];\n    A=1; B=0; C=0; D=1;\n    while ((yp+C) && (yp+D)) {\n      q =Math.floor((xp+A)/(yp+C));\n      qp=Math.floor((xp+B)/(yp+D));\n      if (q!=qp)\n        break;\n      t= A-q*C;   A=C;   C=t;    //  do (A,B,xp, C,D,yp) = (C,D,yp, A,B,xp) - q*(0,0,0, C,D,yp)\n      t= B-q*D;   B=D;   D=t;\n      t=xp-q*yp; xp=yp; yp=t;\n    }\n    if (B) {\n      copy_(T, x);\n      linComb_(x, y, A, B); //x=A*x+B*y\n      linComb_(y, T, D, C); //y=D*y+C*T\n    } else {\n      mod_(x, y);\n      copy_(T, x);\n      copy_(x, y);\n      copy_(y, T);\n    }\n  }\n  if (y[0]==0)\n    return;\n  t=modInt(x, y[0]);\n  copyInt_(x, y[0]);\n  y[0]=t;\n  while (y[0]) {\n    x[0]%=y[0];\n    t=x[0]; x[0]=y[0]; y[0]=t;\n  }\n}\n\n//do x=x**(-1) mod n, for bigInts x and n.\n//If no inverse exists, it sets x to zero and returns 0, else it returns 1.\n//The x array must be at least as large as the n array.\nfunction inverseMod_(x: Bytes, n: Bytes) {\n  var k=1+2*Math.max(x.length, n.length);\n\n  if (!(x[0]&1)  && !(n[0]&1)) {  //if both inputs are even, then inverse doesn't exist\n    copyInt_(x, 0);\n    return 0;\n  }\n\n  if (eg_u.length!=k) {\n    eg_u=new Array(k);\n    eg_v=new Array(k);\n    eg_A=new Array(k);\n    eg_B=new Array(k);\n    eg_C=new Array(k);\n    eg_D=new Array(k);\n  }\n\n  copy_(eg_u, x);\n  copy_(eg_v, n);\n  copyInt_(eg_A, 1);\n  copyInt_(eg_B, 0);\n  copyInt_(eg_C, 0);\n  copyInt_(eg_D, 1);\n  for (;;) {\n    while (!(eg_u[0]&1)) {  //while eg_u is even\n      halve_(eg_u);\n      if (!(eg_A[0]&1) && !(eg_B[0]&1)) { //if eg_A==eg_B==0 mod 2\n        halve_(eg_A);\n        halve_(eg_B);\n      } else {\n        add_(eg_A, n);  halve_(eg_A);\n        sub_(eg_B, x);  halve_(eg_B);\n      }\n    }\n\n    while (!(eg_v[0]&1)) {  //while eg_v is even\n      halve_(eg_v);\n      if (!(eg_C[0]&1) && !(eg_D[0]&1)) { //if eg_C==eg_D==0 mod 2\n        halve_(eg_C);\n        halve_(eg_D);\n      } else {\n        add_(eg_C, n);  halve_(eg_C);\n        sub_(eg_D, x);  halve_(eg_D);\n      }\n    }\n\n    if (!greater(eg_v, eg_u)) { //eg_v <= eg_u\n      sub_(eg_u, eg_v);\n      sub_(eg_A, eg_C);\n      sub_(eg_B, eg_D);\n    } else {                   //eg_v > eg_u\n      sub_(eg_v, eg_u);\n      sub_(eg_C, eg_A);\n      sub_(eg_D, eg_B);\n    }\n\n    if (equalsInt(eg_u, 0)) {\n      while (negative(eg_C)) //make sure answer is nonnegative\n        add_(eg_C, n);\n      copy_(x, eg_C);\n\n      if (!equalsInt(eg_v, 1)) { //if GCD_(x,n)!=1, then there is no inverse\n        copyInt_(x, 0);\n        return 0;\n      }\n      return 1;\n    }\n  }\n}\n\n//return x**(-1) mod n, for integers x and n.  Return 0 if there is no inverse\nfunction inverseModInt(x: number, n: number): number {\n  var a=1, b=0, t;\n  for (;;) {\n    if (x==1) return a;\n    if (x==0) return 0;\n    b-=a*Math.floor(n/x);\n    //$off\n    n%=x;\n\n    if (n==1) return b; //to avoid negatives, change this b to n-b, and each -= to +=\n    if (n==0) return 0;\n    a-=b*Math.floor(x/n);\n    //$off\n    x%=n;\n  }\n  //eslint-disable-next-line\n  return 0\n}\n\n//this deprecated function is for backward compatibility only.\nfunction inverseModInt_(x: number, n: number) {\n   return inverseModInt(x, n);\n}\n\n\n//Given positive bigInts x and y, change the bigints v, a, and b to positive bigInts such that:\n//     v = GCD_(x,y) = a*x-b*y\n//The bigInts v, a, b, must have exactly as many elements as the larger of x and y.\nexport function eGCD_(x: Bytes, y: Bytes, v: Bytes, a: Bytes, b: Bytes) {\n  var g=0;\n  var k=Math.max(x.length, y.length);\n  if (eg_u.length!=k) {\n    eg_u=new Array(k);\n    eg_A=new Array(k);\n    eg_B=new Array(k);\n    eg_C=new Array(k);\n    eg_D=new Array(k);\n  }\n  while (!(x[0]&1)  && !(y[0]&1)) {  //while x and y both even\n    halve_(x);\n    halve_(y);\n    g++;\n  }\n  copy_(eg_u, x);\n  copy_(v, y);\n  copyInt_(eg_A, 1);\n  copyInt_(eg_B, 0);\n  copyInt_(eg_C, 0);\n  copyInt_(eg_D, 1);\n  for (;;) {\n    while (!(eg_u[0]&1)) {  //while u is even\n      halve_(eg_u);\n      if (!(eg_A[0]&1) && !(eg_B[0]&1)) { //if A==B==0 mod 2\n        halve_(eg_A);\n        halve_(eg_B);\n      } else {\n        add_(eg_A, y);  halve_(eg_A);\n        sub_(eg_B, x);  halve_(eg_B);\n      }\n    }\n\n    while (!(v[0]&1)) {  //while v is even\n      halve_(v);\n      if (!(eg_C[0]&1) && !(eg_D[0]&1)) { //if C==D==0 mod 2\n        halve_(eg_C);\n        halve_(eg_D);\n      } else {\n        add_(eg_C, y);  halve_(eg_C);\n        sub_(eg_D, x);  halve_(eg_D);\n      }\n    }\n\n    if (!greater(v, eg_u)) { //v<=u\n      sub_(eg_u, v);\n      sub_(eg_A, eg_C);\n      sub_(eg_B, eg_D);\n    } else {                //v>u\n      sub_(v, eg_u);\n      sub_(eg_C, eg_A);\n      sub_(eg_D, eg_B);\n    }\n    if (equalsInt(eg_u, 0)) {\n      while (negative(eg_C)) {   //make sure a (C) is nonnegative\n        add_(eg_C, y);\n        sub_(eg_D, x);\n      }\n      multInt_(eg_D, -1);  ///make sure b (D) is nonnegative\n      copy_(a, eg_C);\n      copy_(b, eg_D);\n      leftShift_(v, g);\n      return;\n    }\n  }\n}\n\n\n//is bigInt x negative?\nfunction negative(x: Bytes) {\n  return ((x[x.length-1]>>(bpe-1))&1);\n}\n\n\n//is (x << (shift*bpe)) > y?\n//x and y are nonnegative bigInts\n//shift is a nonnegative integer\nfunction greaterShift(x: Bytes, y: Bytes, shift: number) {\n  var i, kx=x.length, ky=y.length;\n  k=((kx+shift)<ky) ? (kx+shift) : ky;\n  for (i=ky-1-shift; i<kx && i>=0; i++)\n    if (x[i]>0)\n      return 1; //if there are nonzeros in x to the left of the first column of y, then x is bigger\n  for (i=kx-1+shift; i<ky; i++)\n    if (y[i]>0)\n      return 0; //if there are nonzeros in y to the left of the first column of x, then x is not bigger\n  for (i=k-1; i>=shift; i--)\n    if      (x[i-shift]>y[i]) return 1;\n    else if (x[i-shift]<y[i]) return 0;\n  return 0;\n}\n\n//is x > y? (x and y both nonnegative)\nexport function greater(x: Bytes, y: Bytes) {\n  var i;\n  var k=(x.length<y.length) ? x.length : y.length;\n\n  for (i=x.length; i<y.length; i++)\n    if (y[i])\n      return 0;  //y has more digits\n\n  for (i=y.length; i<x.length; i++)\n    if (x[i])\n      return 1;  //x has more digits\n\n  for (i=k-1; i>=0; i--)\n    if (x[i]>y[i])\n      return 1;\n    else if (x[i]<y[i])\n      return 0;\n  return 0;\n}\n\n//divide x by y giving quotient q and remainder r.  (q=floor(x/y),  r=x mod y).  All 4 are bigints.\n//x must have at least one leading zero element.\n//y must be nonzero.\n//q and r must be arrays that are exactly the same length as x. (Or q can have more).\n//Must have x.length >= y.length >= 2.\nexport function divide_(x: Bytes, y: Bytes, q: Bytes, r: Bytes) {\n  var kx, ky;\n  var i, j, y1, y2, c, a, b;\n  copy_(r, x);\n  for (ky=y.length; y[ky-1]==0; ky--); //ky is number of elements in y, not including leading zeros\n\n  //normalize: ensure the most significant element of y has its highest bit set\n  b=y[ky-1];\n  for (a=0; b; a++)\n    b>>=1;\n  a=bpe-a;  //a is how many bits to shift so that the high order bit of y is leftmost in its array element\n  leftShift_(y, a);  //multiply both by 1<<a now, then divide both by that at the end\n  leftShift_(r, a);\n\n  //Rob Visser discovered a bug: the following line was originally just before the normalization.\n  for (kx=r.length; r[kx-1]==0 && kx>ky; kx--); //kx is number of elements in normalized x, not including leading zeros\n\n  copyInt_(q, 0);                      // q=0\n  while (!greaterShift(y, r, kx-ky)) {  // while (leftShift_(y,kx-ky) <= r) {\n    subShift_(r, y, kx-ky);             //   r=r-leftShift_(y,kx-ky)\n    q[kx-ky]++;                       //   q[kx-ky]++;\n  }                                   // }\n\n  for (i=kx-1; i>=ky; i--) {\n    if (r[i]==y[ky-1])\n      q[i-ky]=mask;\n    else\n      q[i-ky]=Math.floor((r[i]*radix+r[i-1])/y[ky-1]);\n\n    //The following for(;;) loop is equivalent to the commented while loop,\n    //except that the uncommented version avoids overflow.\n    //The commented loop comes from HAC, which assumes r[-1]==y[-1]==0\n    //  while (q[i-ky]*(y[ky-1]*radix+y[ky-2]) > r[i]*radix*radix+r[i-1]*radix+r[i-2])\n    //    q[i-ky]--;\n    for (;;) {\n      y2=(ky>1 ? y[ky-2] : 0)*q[i-ky];\n      c=y2>>bpe;\n      y2=y2 & mask;\n      y1=c+q[i-ky]*y[ky-1];\n      c=y1>>bpe;\n      y1=y1 & mask;\n\n      if (c==r[i] ? y1==r[i-1] ? y2>(i>1 ? r[i-2] : 0) : y1>r[i-1] : c>r[i])\n        q[i-ky]--;\n      else\n        break;\n    }\n\n    linCombShift_(r, y, -q[i-ky], i-ky);    //r=r-q[i-ky]*leftShift_(y,i-ky)\n    if (negative(r)) {\n      addShift_(r, y, i-ky);         //r=r+leftShift_(y,i-ky)\n      q[i-ky]--;\n    }\n  }\n\n  rightShift_(y, a);  //undo the normalization step\n  rightShift_(r, a);  //undo the normalization step\n}\n\n//do carries and borrows so each element of the bigInt x fits in bpe bits.\nfunction carry_(x: Bytes) {\n  var i, k, c, b;\n  k=x.length;\n  c=0;\n  for (i=0; i<k; i++) {\n    c+=x[i];\n    b=0;\n    if (c<0) {\n      b=-(c>>bpe);\n      c+=b*radix;\n    }\n    x[i]=c & mask;\n    c=(c>>bpe)-b;\n  }\n}\n\n//return x mod n for bigInt x and integer n.\nfunction modInt(x: Bytes, n: number) {\n  var i, c=0;\n  for (i=x.length-1; i>=0; i--)\n    c=(c*radix+x[i])%n;\n  return c;\n}\n\n//convert the integer t into a bigInt with at least the given number of bits.\n//the returned array stores the bigInt in bpe-bit chunks, little endian (buff[0] is least significant word)\n//Pad the array with leading zeros so that it has at least minSize elements.\n//There will always be at least one leading 0 element.\nexport function int2bigInt(t: number, bits: number, minSize: number) {\n  var i, k;\n  k=Math.ceil(bits/bpe)+1;\n  k=minSize>k ? minSize : k;\n  var buff=new Array(k);\n  copyInt_(buff, t);\n  return buff;\n}\n\n//return the bigInt given a string representation in a given base.\n//Pad the array with leading zeros so that it has at least minSize elements.\n//If base=-1, then it reads in a space-separated list of array elements in decimal.\n//The array will always have at least one leading zero, unless base=-1.\nexport function str2bigInt(s: string, base: number, minSize?: number): Bytes {\n  var d, i, x, y, kk;\n  var k=s.length;\n  if (base==-1) { //comma-separated list of array elements in decimal\n    x=new Array(0);\n    for (;;) {\n      y=new Array(x.length+1);\n      for (i=0; i<x.length; i++)\n        y[i+1]=x[i];\n      y[0]=parseInt(s, 10); //TODO PERF Should we replace that with ~~ (not not)? https://jsperf.com/number-vs-parseint-vs-plus/7\n      x=y;\n      d=s.indexOf(',', 0);\n      if (d<1)\n        break;\n      //$off\n      s=s.substring(d+1);\n      if (s.length==0)\n        break;\n    }\n    //$off\n    if (x.length<minSize) {\n      //$off\n      y=new Array(minSize);\n      copy_(y, x);\n      return y;\n    }\n    return x;\n  }\n\n  x=int2bigInt(0, base*k, 0);\n  for (i=0; i<k; i++) {\n    d=digitsStr.indexOf(s.substring(i, i+1), 0);\n    if (base<=36 && d>=36)  //convert lowercase to uppercase if base<=36\n      d-=26;\n    if (d>=base || d<0) {   //stop at first illegal character\n      break;\n    }\n    multInt_(x, base);\n    addInt_(x, d);\n  }\n\n  for (k=x.length; k>0 && !x[k-1]; k--); //strip off leading zeros\n  //$off\n  k=minSize>k+1 ? minSize : k+1;\n  //$off\n  y=new Array(k);\n  //$off\n  kk=k<x.length ? k : x.length;\n  //$off\n  for (i=0; i<kk; i++)\n    y[i]=x[i];\n  //$off\n  for (;i<k; i++)\n    y[i]=0;\n  return y;\n}\n\n//is bigint x equal to integer y?\n//y must have less than bpe bits\nexport function equalsInt(x: Bytes, y: number) {\n  var i;\n  if (x[0]!=y)\n    return 0;\n  for (i=1; i<x.length; i++)\n    if (x[i])\n      return 0;\n  return 1;\n}\n\n//are bigints x and y equal?\n//this works even if x and y are different lengths and have arbitrarily many leading zeros\nfunction equals(x: Bytes, y: Bytes) {\n  var i;\n  var k=x.length<y.length ? x.length : y.length;\n  for (i=0; i<k; i++)\n    if (x[i]!=y[i])\n      return 0;\n  if (x.length>y.length) {\n    for (;i<x.length; i++)\n      if (x[i])\n        return 0;\n  } else {\n    for (;i<y.length; i++)\n      if (y[i])\n        return 0;\n  }\n  return 1;\n}\n\n//is the bigInt x equal to zero?\nexport function isZero(x: Bytes) {\n  var i;\n  for (i=0; i<x.length; i++)\n    if (x[i])\n      return 0;\n  return 1;\n}\n\n//convert a bigInt into a string in a given base, from base 2 up to base 95.\n//Base -1 prints the contents of the array representing the number.\nexport function bigInt2str(x: Bytes, base: number) {\n  var i, t, s='';\n\n  if (s6.length!=x.length)\n    s6=dup(x);\n  else\n    copy_(s6, x);\n\n  if (base==-1) { //return the list of array contents\n    for (i=x.length-1; i>0; i--)\n      s+=x[i]+',';\n    s+=x[0];\n  }\n  else { //return it in the given base\n    while (!isZero(s6)) {\n      t=divInt_(s6, base);  //t=s6 % base; s6=floor(s6/base);\n      s=digitsStr.substring(t, t+1)+s;\n    }\n  }\n  if (s.length==0)\n    s='0';\n  return s;\n}\n\n//returns a duplicate of bigInt x\nexport function dup(x: Bytes) {\n  var i;\n  buff=new Array(x.length);\n  copy_(buff, x);\n  return buff;\n}\n\n//do x=y on bigInts x and y.  x must be an array at least as big as y (not counting the leading zeros in y).\nexport function copy_(x: Bytes, y: Bytes) {\n  var i;\n  var k=x.length<y.length ? x.length : y.length;\n  for (i=0; i<k; i++)\n    x[i]=y[i];\n  for (i=k; i<x.length; i++)\n    x[i]=0;\n}\n\n//do x=y on bigInt x and integer y.\nexport function copyInt_(x: Bytes, n: number) {\n  var i, c;\n  var len = x.length; //TODO .length in for loop have perfomance costs. Bench this\n  for (c=n, i=0; i<len; i++) {\n    x[i]=c & mask;\n    c>>=bpe;\n  }\n}\n\n//do x=x+n where x is a bigInt and n is an integer.\n//x must be large enough to hold the result.\nexport function addInt_(x: Bytes, n: number) {\n  var i, k, c, b;\n  x[0]+=n;\n  k=x.length;\n  c=0;\n  for (i=0; i<k; i++) {\n    c+=x[i];\n    b=0;\n    if (c<0) {\n      b=-(c>>bpe);\n      c+=b*radix;\n    }\n    x[i]=c & mask;\n    c=(c>>bpe)-b;\n    if (!c) return; //stop carrying as soon as the carry is zero\n  }\n}\n\n//right shift bigInt x by n bits.  0 <= n < bpe.\nexport function rightShift_(x: Bytes, n: number) {\n  var i;\n  var k=Math.floor(n/bpe);\n  if (k) {\n    for (i=0; i<x.length-k; i++) //right shift x by k elements\n      x[i]=x[i+k];\n    for (;i<x.length; i++)\n      x[i]=0;\n    //$off\n    n%=bpe;\n  }\n  for (i=0; i<x.length-1; i++) {\n    x[i]=mask & ((x[i+1]<<(bpe-n)) | (x[i]>>n));\n  }\n  x[i]>>=n;\n}\n\n//do x=floor(|x|/2)*sgn(x) for bigInt x in 2's complement\nfunction halve_(x: Bytes) {\n  var i;\n  for (i=0; i<x.length-1; i++) {\n    x[i]=mask & ((x[i+1]<<(bpe-1)) | (x[i]>>1));\n  }\n  x[i]=(x[i]>>1) | (x[i] & (radix>>1));  //most significant bit stays the same\n}\n\n//left shift bigInt x by n bits.\nexport function leftShift_(x: Bytes, n: number) {\n  var i;\n  var k=Math.floor(n/bpe);\n  if (k) {\n    for (i=x.length; i>=k; i--) //left shift x by k elements\n      x[i]=x[i-k];\n    for (;i>=0; i--)\n      x[i]=0;\n    //$off\n    n%=bpe;\n  }\n  if (!n)\n    return;\n  for (i=x.length-1; i>0; i--) {\n    x[i]=mask & ((x[i]<<n) | (x[i-1]>>(bpe-n)));\n  }\n  x[i]=mask & (x[i]<<n);\n}\n\n//do x=x*n where x is a bigInt and n is an integer.\n//x must be large enough to hold the result.\nfunction multInt_(x: Bytes, n: number) {\n  var i, k, c, b;\n  if (!n)\n    return;\n  k=x.length;\n  c=0;\n  for (i=0; i<k; i++) {\n    c+=x[i]*n;\n    b=0;\n    if (c<0) {\n      b=-(c>>bpe);\n      c+=b*radix;\n    }\n    x[i]=c & mask;\n    c=(c>>bpe)-b;\n  }\n}\n\n//do x=floor(x/n) for bigInt x and integer n, and return the remainder\nfunction divInt_(x: Bytes, n: number) {\n  var i, r=0, s;\n  for (i=x.length-1; i>=0; i--) {\n    s=r*radix+x[i];\n    x[i]=Math.floor(s/n);\n    r=s%n;\n  }\n  return r;\n}\n\n//do the linear combination x=a*x+b*y for bigInts x and y, and integers a and b.\n//x must be large enough to hold the answer.\nfunction linComb_(x: Bytes, y: Bytes, a: number, b: number) {\n  var i, c, k, kk;\n  k=x.length<y.length ? x.length : y.length;\n  kk=x.length;\n  for (c=0, i=0; i<k; i++) {\n    c+=a*x[i]+b*y[i];\n    x[i]=c & mask;\n    c>>=bpe;\n  }\n  for (i=k; i<kk; i++) {\n    c+=a*x[i];\n    x[i]=c & mask;\n    c>>=bpe;\n  }\n}\n\n//do the linear combination x=a*x+b*(y<<(ys*bpe)) for bigInts x and y, and integers a, b and ys.\n//x must be large enough to hold the answer.\nfunction linCombShift_(x: Bytes, y: Bytes, b: number, ys: number) {\n  var i, c, k, kk;\n  k=x.length<ys+y.length ? x.length : ys+y.length;\n  kk=x.length;\n  for (c=0, i=ys; i<k; i++) {\n    c+=x[i]+b*y[i-ys];\n    x[i]=c & mask;\n    c>>=bpe;\n  }\n  for (i=k; c && i<kk; i++) {\n    c+=x[i];\n    x[i]=c & mask;\n    c>>=bpe;\n  }\n}\n\n//do x=x+(y<<(ys*bpe)) for bigInts x and y, and integers a,b and ys.\n//x must be large enough to hold the answer.\nfunction addShift_(x: Bytes, y: Bytes, ys: number) {\n  var i, c, k, kk;\n  k=x.length<ys+y.length ? x.length : ys+y.length;\n  kk=x.length;\n  for (c=0, i=ys; i<k; i++) {\n    c+=x[i]+y[i-ys];\n    x[i]=c & mask;\n    c>>=bpe;\n  }\n  for (i=k; c && i<kk; i++) {\n    c+=x[i];\n    x[i]=c & mask;\n    c>>=bpe;\n  }\n}\n\n//do x=x-(y<<(ys*bpe)) for bigInts x and y, and integers a,b and ys.\n//x must be large enough to hold the answer.\nfunction subShift_(x: Bytes, y: Bytes, ys: number) {\n  var i, c, k, kk;\n  k=x.length<ys+y.length ? x.length : ys+y.length;\n  kk=x.length;\n  for (c=0, i=ys; i<k; i++) {\n    c+=x[i]-y[i-ys];\n    x[i]=c & mask;\n    c>>=bpe;\n  }\n  for (i=k; c && i<kk; i++) {\n    c+=x[i];\n    x[i]=c & mask;\n    c>>=bpe;\n  }\n}\n\n//do x=x-y for bigInts x and y.\n//x must be large enough to hold the answer.\n//negative answers will be 2s complement\nexport function sub_(x: Bytes, y: Bytes) {\n  var i, c, k, kk;\n  k=x.length<y.length ? x.length : y.length;\n  for (c=0, i=0; i<k; i++) {\n    c+=x[i]-y[i];\n    x[i]=c & mask;\n    c>>=bpe;\n  }\n  for (i=k; c && i<x.length; i++) {\n    c+=x[i];\n    x[i]=c & mask;\n    c>>=bpe;\n  }\n}\n\n//do x=x+y for bigInts x and y.\n//x must be large enough to hold the answer.\nexport function add_(x: Bytes, y: Bytes) {\n  var i, c, k, kk;\n  k=x.length<y.length ? x.length : y.length;\n  for (c=0, i=0; i<k; i++) {\n    c+=x[i]+y[i];\n    x[i]=c & mask;\n    c>>=bpe;\n  }\n  for (i=k; c && i<x.length; i++) {\n    c+=x[i];\n    x[i]=c & mask;\n    c>>=bpe;\n  }\n}\n\n//do x=x*y for bigInts x and y.  This is faster when y<x.\nfunction mult_(x: Bytes, y: Bytes) {\n  var i;\n  if (ss.length!=2*x.length)\n    ss=new Array(2*x.length);\n  copyInt_(ss, 0);\n  for (i=0; i<y.length; i++)\n    if (y[i])\n      linCombShift_(ss, x, y[i], i);   //ss=1*ss+y[i]*(x<<(i*bpe))\n  copy_(x, ss);\n}\n\n//do x=x mod n for bigInts x and n.\nfunction mod_(x: Bytes, n: Bytes) {\n  if (s4.length!=x.length)\n    s4=dup(x);\n  else\n    copy_(s4, x);\n  if (s5.length!=x.length)\n    s5=dup(x);\n  divide_(s4, n, s5, x);  //x = remainder of s4 / n\n}\n\n//do x=x*y mod n for bigInts x,y,n.\n//for greater speed, let y<x.\nfunction multMod_(x: Bytes, y: Bytes, n: Bytes) {\n  var i;\n  if (s0.length!=2*x.length)\n    s0=new Array(2*x.length);\n  copyInt_(s0, 0);\n  for (i=0; i<y.length; i++)\n    if (y[i])\n      linCombShift_(s0, x, y[i], i);   //s0=1*s0+y[i]*(x<<(i*bpe))\n  mod_(s0, n);\n  copy_(x, s0);\n}\n\n//do x=x*x mod n for bigInts x,n.\nfunction squareMod_(x: Bytes, n: Bytes) {\n  var i, j, d, c, kx, kn, k;\n  for (kx=x.length; kx>0 && !x[kx-1]; kx--);  //ignore leading zeros in x\n  k=kx>n.length ? 2*kx : 2*n.length; //k=# elements in the product, which is twice the elements in the larger of x and n\n  if (s0.length!=k)\n    s0=new Array(k);\n  copyInt_(s0, 0);\n  for (i=0; i<kx; i++) {\n    c=s0[2*i]+x[i]*x[i];\n    s0[2*i]=c & mask;\n    c>>=bpe;\n    for (j=i+1; j<kx; j++) {\n      c=s0[i+j]+2*x[i]*x[j]+c;\n      s0[i+j]=(c & mask);\n      c>>=bpe;\n    }\n    s0[i+kx]=c;\n  }\n  mod_(s0, n);\n  copy_(x, s0);\n}\n\n//return x with exactly k leading zero elements\nfunction trim(x: Bytes, k: number) {\n  var i, y;\n  for (i=x.length; i>0 && !x[i-1]; i--);\n  y=new Array(i+k);\n  copy_(y, x);\n  return y;\n}\n\n//do x=x**y mod n, where x,y,n are bigInts and ** is exponentiation.  0**0=1.\n//this is faster when n is odd.  x usually needs to have as many elements as n.\nfunction powMod_(x: Bytes, y: Bytes, n: Bytes) {\n  var k1, k2, kn, np;\n  if (s7.length!=n.length)\n    s7=dup(n);\n\n  //for even modulus, use a simple square-and-multiply algorithm,\n  //rather than using the more complex Montgomery algorithm.\n  if ((n[0]&1)==0) {\n    copy_(s7, x);\n    copyInt_(x, 1);\n    while (!equalsInt(y, 0)) {\n      if (y[0]&1)\n        multMod_(x, s7, n);\n      divInt_(y, 2);\n      squareMod_(s7, n);\n    }\n    return;\n  }\n\n  //calculate np from n for the Montgomery multiplications\n  copyInt_(s7, 0);\n  for (kn=n.length; kn>0 && !n[kn-1]; kn--);\n  np=radix-inverseModInt(modInt(n, radix), radix);\n  s7[kn]=1;\n  multMod_(x, s7, n);   // x = x * 2**(kn*bp) mod n\n\n  if (s3.length!=x.length)\n    s3=dup(x);\n  else\n    copy_(s3, x);\n  //$off\n  for (k1=y.length-1; k1>0 & !y[k1]; k1--);  //k1=first nonzero element of y\n  if (y[k1]==0) {  //anything to the 0th power is 1\n    copyInt_(x, 1);\n    return;\n  }\n  for (k2=1<<(bpe-1); k2 && !(y[k1] & k2); k2>>=1);  //k2=position of first 1 bit in y[k1]\n  for (;;) {\n    if (!(k2>>=1)) {  //look at next bit of y\n      k1--;\n      if (k1<0) {\n        mont_(x, one, n, np);\n        return;\n      }\n      k2=1<<(bpe-1);\n    }\n    mont_(x, x, n, np);\n\n    if (k2 & y[k1]) //if next bit is a 1\n      mont_(x, s3, n, np);\n  }\n}\n\n\n//do x=x*y*Ri mod n for bigInts x,y,n,\n//  where Ri = 2**(-kn*bpe) mod n, and kn is the\n//  number of elements in the n array, not\n//  counting leading zeros.\n//x array must have at least as many elemnts as the n array\n//It's OK if x and y are the same variable.\n//must have:\n//  x,y < n\n//  n is odd\n//  np = -(n^(-1)) mod radix\nfunction mont_(x: Bytes, y: Bytes, n: Bytes, np: number) {\n  var i, j, c, ui, t, ks;\n  var kn=n.length;\n  var ky=y.length;\n\n  if (sa.length!=kn)\n    sa=new Array(kn);\n\n  copyInt_(sa, 0);\n\n  for (;kn>0 && n[kn-1]==0; kn--); //ignore leading zeros of n\n  for (;ky>0 && y[ky-1]==0; ky--); //ignore leading zeros of y\n  ks=sa.length-1; //sa will never have more than this many nonzero elements.\n\n  //the following loop consumes 95% of the runtime for randTruePrime_() and powMod_() for large numbers\n  for (i=0; i<kn; i++) {\n    t=sa[0]+x[i]*y[0];\n    ui=((t & mask) * np) & mask;  //the inner \"& mask\" was needed on Safari (but not MSIE) at one time\n    c=(t+ui*n[0]) >> bpe;\n    t=x[i];\n\n    //do sa=(sa+x[i]*y+ui*n)/b   where b=2**bpe.  Loop is unrolled 5-fold for speed\n    j=1;\n    for (;j<ky-4;) { c+=sa[j]+ui*n[j]+t*y[j];   sa[j-1]=c & mask;   c>>=bpe;   j++;\n                     c+=sa[j]+ui*n[j]+t*y[j];   sa[j-1]=c & mask;   c>>=bpe;   j++;\n                     c+=sa[j]+ui*n[j]+t*y[j];   sa[j-1]=c & mask;   c>>=bpe;   j++;\n                     c+=sa[j]+ui*n[j]+t*y[j];   sa[j-1]=c & mask;   c>>=bpe;   j++;\n                     c+=sa[j]+ui*n[j]+t*y[j];   sa[j-1]=c & mask;   c>>=bpe;   j++; }\n    for (;j<ky;)   { c+=sa[j]+ui*n[j]+t*y[j];   sa[j-1]=c & mask;   c>>=bpe;   j++; }\n    for (;j<kn-4;) { c+=sa[j]+ui*n[j];          sa[j-1]=c & mask;   c>>=bpe;   j++;\n                     c+=sa[j]+ui*n[j];          sa[j-1]=c & mask;   c>>=bpe;   j++;\n                     c+=sa[j]+ui*n[j];          sa[j-1]=c & mask;   c>>=bpe;   j++;\n                     c+=sa[j]+ui*n[j];          sa[j-1]=c & mask;   c>>=bpe;   j++;\n                     c+=sa[j]+ui*n[j];          sa[j-1]=c & mask;   c>>=bpe;   j++; }\n    for (;j<kn;)   { c+=sa[j]+ui*n[j];          sa[j-1]=c & mask;   c>>=bpe;   j++; }\n    for (;j<ks;)   { c+=sa[j];                  sa[j-1]=c & mask;   c>>=bpe;   j++; }\n    sa[j-1]=c & mask;\n  }\n\n  if (!greater(n, sa))\n    sub_(sa, n);\n  copy_(x, sa);\n}\n\n"]}